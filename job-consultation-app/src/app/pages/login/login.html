<div class="login-container">
 <div class="logo-section">
   <div class="logo">
	 <h1>JC</h1>
	 <p>Quick Question? Cheap answer</p>
   </div>
 </div>
 <div class="form-section">
   <ion-card>
	 <ion-card-content>
	   <div class="api-status">
		 API Status: 
		 <span [ngClass]="{
		   'connected': apiStatus === 'Connected',
		   'failed': apiStatus === 'Failed',
		   'testing': apiStatus === 'Checking...'
		 }">{{apiStatus}}</span>
		 <ion-button size="small" fill="clear" (click)="testApiConnection()">Test</ion-button>
	   </div>

	   <!-- Show offline login option -->
	   <div class="offline-login" *ngIf="apiStatus !== 'Connected'">
		 <p>Can't connect to server? Use test credentials:</p>
		 <p><strong>Email:</strong> test&#64;test.com</p>
		 <p><strong>Password:</strong> test</p>
	   </div>

	   <div class="form-field" *ngIf="!isLogin">
		 <ion-input 
		   class="input-field"
		   label="Username" 
		   labelPlacement="floating"
		   placeholder="Enter your username"
		   type="text" 
		   [ngModel]="username" 
		   (ngModelChange)="username = $event">
		 </ion-input>
	   </div>
	   
	   <div class="form-field" *ngIf="!isLogin">
		 <ion-input 
		   class="input-field"
		   label="Full Name" 
		   labelPlacement="floating"
		   placeholder="Enter your full name"
		   type="text" 
		   [ngModel]="fullName" 
		   (ngModelChange)="fullName = $event">
		 </ion-input>
	   </div>
	   
	   <div class="form-field email-field">
		 <ion-input 
		   class="input-field email-input"
		   label="Email" 
		   labelPlacement="floating"
		   placeholder="Enter your email"
		   type="email" 
		   [ngModel]="email" 
		   (ngModelChange)="email = $event">
		 </ion-input>
	   </div>
		 
		 <div class="form-field password-field">
		 <ion-input 
		   class="input-field"
		   label="Password" 
		   labelPlacement="floating"
		   placeholder="Enter your password"
		   type="password" 
		   [ngModel]="password" 
		   (ngModelChange)="password = $event">
		 </ion-input>
	   </div>
		 
		 <ion-radio-group *ngIf="!isLogin" [ngModel]="userType" (ngModelChange)="userType = $event">
		   <ion-item lines="none">
			 <ion-radio value="client">I want to hire a consultant</ion-radio>
		   </ion-item>
		   <ion-item lines="none"> 
			 <ion-radio value="seller">I want to offer consultations</ion-radio>
		   </ion-item>
		 </ion-radio-group>
		 
		 <div class="ion-padding button-container">
		   <ion-button expand="block" (click)="handleAuth()" class="login-button" [disabled]="isSubmitting">
			 {{ isLogin ? 'Login' : 'Register' }}
		   </ion-button>
		   
		   <ion-button *ngIf="isLogin" expand="block" class="secondary-button" (click)="loginWith42()" [disabled]="isSubmitting || apiStatus !== 'Connected'">
			 <img src="assets/icons/42_logo.svg" alt="42" class="button-icon" />
			 Login with 42
		   </ion-button>
		   
		   <ion-button expand="block" fill="outline" color="medium" (click)="showOAuthRedirectInfo()" class="ion-margin-top">
			 <ion-icon name="information-circle-outline" slot="start"></ion-icon>
			 Configure 42 OAuth (Fix Redirect URI)
		   </ion-button>
		   
		   <ion-card *ngIf="showOAuthInfo && oauthRedirectUris" class="ion-margin-top">
			 <ion-card-header>
			   <ion-card-title>Fix "Redirect URI is not valid" Error</ion-card-title>
			   <ion-card-subtitle>Add these URIs to your 42 OAuth App</ion-card-subtitle>
			 </ion-card-header>
			 <ion-card-content>
			   <div class="uri-container">
				 <h4>Web Redirect URI:</h4>
				 <div class="uri-display">
				   <code>{{ oauthRedirectUris.web }}</code>
				   <ion-button size="small" fill="clear" (click)="copyToClipboard(oauthRedirectUris.web)">
					 <ion-icon name="copy-outline"></ion-icon>
				   </ion-button>
				 </div>
				 
				 <h4>Mobile Redirect URI:</h4>
				 <div class="uri-display">
				   <code>{{ oauthRedirectUris.mobile }}</code>
				   <ion-button size="small" fill="clear" (click)="copyToClipboard(oauthRedirectUris.mobile)">
					 <ion-icon name="copy-outline"></ion-icon>
				   </ion-button>
				 </div>
				 
				 <div class="setup-instructions">
				   <h5>How to fix:</h5>
				   <ol>
					 <li>Go to <a href="https://profile.intra.42.fr/oauth/applications" target="_blank">42 API Applications</a></li>
					 <li>Find your app and click "Edit"</li>
					 <li>Add <strong>both</strong> URIs to the "Redirect URI" field (one per line)</li>
					 <li>Click "Submit" to save changes</li>
				   </ol>
				 </div>
				 
				 <ion-item-divider class="ion-margin-top">
				   <ion-label>Advanced Troubleshooting</ion-label>
				 </ion-item-divider>
				 
				 <div class="custom-uri-section">
				   <p>If you are still having issues, try specifying custom redirect URIs:</p>
				   
				   <ion-item>
					 <ion-label position="stacked">Custom Web Redirect URI</ion-label>
					 <ion-input [(ngModel)]="customWebUri" placeholder="e.g., http://localhost:4200/auth/callback"></ion-input>
				   </ion-item>
				   
				   <ion-item>
					 <ion-label position="stacked">Custom Mobile Redirect URI</ion-label>
					 <ion-input [(ngModel)]="customMobileUri" placeholder="e.g., com.jobconsultation.app://callback"></ion-input>
				   </ion-item>
				   
				   <ion-button expand="block" class="ion-margin-top" (click)="setCustomRedirectUris()" [disabled]="!customWebUri && !customMobileUri">
					 Save Custom URIs
				   </ion-button>
				 </div>
			   </div>
			 </ion-card-content>
		   </ion-card>
		   
		   <ion-button expand="block" fill="clear" (click)="toggleMode()" class="toggle-button">
			 {{ isLogin ? 'Need an account? Register' : 'Already have an account? Login' }}
		   </ion-button>
		 </div>
	   </ion-card-content>
	 </ion-card>
   </div>
 </div>